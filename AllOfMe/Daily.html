<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title></title>
	<meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<script src="/Scripts/god.js"></script>

	<script src="Scripts/knockout-3.4.2.debug.js"></script>
	<script src="/Scripts/AllOfMe/Daily/ViewModel.js"></script>

	<script src="/Scripts/CSharp/Me.js"></script>
	<script src="Scripts/god.web.js"></script>
	<script src="/Scripts/Javascript/Me.js"></script>

	<script src="/Scripts/AllOfMe/Daily/Effects.js"></script>

	<link href="App_Themes/AllOfMe/Daily.css" rel="stylesheet" />
</head>
<body>
	<!--ko if:!Name()-->
	<form>
		<input type="text" required name="name" placeholder="用户名" />
		<input type="password" required name="password" placeholder="密码" />
		<input type="button" value="确定" onclick="me.WakeUp(this);" />
	</form>
	<!--/ko-->
	<!--ko if:Name()&&!CurrentPlan()-->
	<div>
		<h1 data-bind="text:Name" onclick="me.Sleep();"></h1>
		<ul data-bind="foreach: Plans">
			<li>
				<h5 data-bind="text: Content,click:function(){me.QueryEfforts(Id);}"></h5>
				<time data-bind="text: AppearTime,click:function(){me.GiveUp(Id);}"></time><span style="float: right;" data-bind="text: Done()?'已完成':'进行中'"></span>
			</li>
		</ul>
		<table>
			<tr>
				<td><a href="javascript:toggleForms(newPlanForm);">新的计划</a></td>
				<td><a href="javascript:toggleForms(queryPlansForm);">回顾</a></td>
			</tr>
		</table>
		<div class="conditions">
			<div>
				<p>查询状态</p>
				<div>始于：<time data-bind="text:PlanStart"></time></div>
				<div>止于：<time data-bind="text:PlanEnd"></time></div>
				<div>状态：<span data-bind="text:DoneStateText"></span></div>
			</div>
			<form id="newPlanForm">
				<input name="thing" required placeholder="新计划" data-bind="value:PendingPlan" />
				<input type="button" onclick="me.Desire(this);this.previousElementSibling.focus();" value="确定" />
			</form>
			<form id="queryPlansForm" data-god="QueryPlans">
				<input type="date" name="start" data-bind="value: PlanStart" placeholder="始于" />
				<input type="date" name="end" data-bind="value: PlanEnd" placeholder="止于" />
				<div>
					<label>全部：<input type="radio" name="done" value="all" data-bind="checked:DoneState,checkedValue" /></label>
					<label>未完成：<input type="radio" name="done" value="false" data-bind="checked:DoneState" /></label>
					<label>已完成：<input type="radio" name="done" value="true" data-bind="checked:DoneState" /></label>
				</div>
				<input type="hidden" name="take" value="4" />
				<input type="hidden" name="skip" data-bind="value:$root.PlansSkip" />
				<input type="button" value="确定" onclick="vm.PlansSkip(0);me.QueryPlans();" />
				<!--ko if:Plans().length-->
				<input type="button" value="加载更多" onclick="vm.PlansSkip(vm.Plans().length); me.QueryPlans();" />
				<!--/ko-->
			</form>
		</div>
	</div>
	<!--/ko-->
	<div data-bind="with:CurrentPlan">
		<h1 data-bind="text:Content,click:function(){$root.CurrentPlan(null);}"></h1>
		<time data-bind="text: AppearTime"></time>
		<ul data-bind="foreach:Efforts">
			<li>
				<article data-bind="text: Content"></article>
				<time data-bind="text: AppearTime,click:function(){DeleteEffort(Id);}"></time>
			</li>
		</ul>
		<table>
			<tr>
				<td onclick="toggleForms(newEffortForm);">继续努力</td>
				<td onclick="toggleForms(queryEffortsForm);">回顾</td>
				<td data-bind="click:function(){me.GiveUp(Id);},attr:{disabled:Done()}">放弃</td>
				<td data-bind="click:function(){me.Finish(Id);},attr:{disabled:Done()}">完成</td>
			</tr>
		</table>
		<div class="conditions">
			<div>
				<p>查询状态</p>
				<div>始于：<time data-bind="text:$root.EffortStart"></time></div>
				<div>止于：<time data-bind="text:$root.EffortEnd"></time></div>
				<div>状态：<span data-bind="text:Done()?'已完成':'未完成'"></span></div>
			</div>
			<form id="queryEffortsForm" data-god="QueryEfforts">
				<input type="hidden" name="planId" data-bind="value: Id" />
				<input type="date" name="effortStart" data-bind="value:$root.EffortStart" />
				<input type="date" name="effortEnd" data-bind="value:$root.EffortEnd" />
				<input type="hidden" name="take" value="4" />
				<input type="hidden" name="skip" data-bind="value:$root.EffortsSkip" />
				<input type="button" value="确定" onclick="me.QueryEfforts(this);" />
			</form>
			<form id="newEffortForm">
				<input type="hidden" name="planId" data-bind="value: Id" />
				<textarea name="content" data-bind="value:$root.PendingEffort" required placeholder="继续努力"></textarea>
				<input type="button" value="确定" onclick="me.Pay(this); this.previousElementSibling.focus();" />
				<input type="button" value="加载更多" onclick="$root.EffortsSkip(Efforts().length); me.QueryEfforts();" />
			</form>
		</div>
	</div>
</body>
</html>